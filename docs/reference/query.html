<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Search DataONE for data and metadata objects — query • dataone</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Search DataONE for data and metadata objects — query" />
<meta property="og:description" content="The DataONE search index is searched for data that matches the specified query parameters." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dataone</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v01-dataone-overview.html">dataone Package Overview</a>
    </li>
    <li>
      <a href="../articles/v02-dataone-federation.html">DataONE Federation</a>
    </li>
    <li>
      <a href="../articles/v03-searching-dataone.html">Searching DataONE Data Holdings</a>
    </li>
    <li>
      <a href="../articles/v04-download-data.html">Downloading Data From DataONE</a>
    </li>
    <li>
      <a href="../articles/v05-upload-data.html">Uploading Datasets to DataONE</a>
    </li>
    <li>
      <a href="../articles/v06-update-package.html">Updating Datasets on DataONE</a>
    </li>
    <li>
      <a href="../articles/v07-known-issues.html">Known Issues</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/DataONEorg/rdataone/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Search DataONE for data and metadata objects</h1>
    <small class="dont-index">Source: <a href='https://github.com/DataONEorg/rdataone/blob/master/R/D1Node.R'><code>R/D1Node.R</code></a></small>
    <div class="hidden name"><code>query.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The DataONE search index is searched for data that matches the specified query parameters.</p>
    </div>

    <pre class="usage"><span class='fu'>query</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for D1Node</span>
<span class='fu'>query</span><span class='op'>(</span>
  <span class='va'>x</span>,
  solrQuery <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>,
  encode <span class='op'>=</span> <span class='cn'>TRUE</span>,
  as <span class='op'>=</span> <span class='st'>"list"</span>,
  parse <span class='op'>=</span> <span class='cn'>TRUE</span>,
  searchTerms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='cn'>NA</span><span class='op'>)</span>,
  encodeReserved <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>The CNode or MNode instance to send the query to.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>(Not yet used.)</p></td>
    </tr>
    <tr>
      <th>solrQuery</th>
      <td><p>The query search terms, either as a string or as list with named members.</p></td>
    </tr>
    <tr>
      <th>encode</th>
      <td><p>A logical, if <code>TRUE</code> then the query is URL encoded. The default is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>as</th>
      <td><p>The return type. Possible values: "json", "xml", "list" or "data.frame" with "list" as the default.</p></td>
    </tr>
    <tr>
      <th>parse</th>
      <td><p>A logical value. If TRUE, then the result is parsed and converted to appropriate R data types. If FALSE, character values are returned.</p></td>
    </tr>
    <tr>
      <th>searchTerms</th>
      <td><p>A list of name / value pairs (an alternative to <code>solrQuery</code>).</p></td>
    </tr>
    <tr>
      <th>encodeReserved</th>
      <td><p>A logical, if TRUE then reserved characters in the query are URL encoded (FALSE is default). See <code>URLencode</code> for details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>search results as a list, data.frame or XML document</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>"query"</code> method sends a query to a DataONE search index that uses the Apache Solr search 
engine <a href='https://lucene.apache.org/solr/'>https://lucene.apache.org/solr/</a>. This same Solr search engine is the underlying mechanism used by the
DataONE online search tool available at <a href='https://search.dataone.org/'>https://search.dataone.org/</a>.</p>
<p>The <code>"solrQuery"</code> argument is used to specify search terms that data of interest must match. This parameter uses
Solr query terms, so some familiarity with Solr is helpful, however, fairly simple queries can be effective. This
argument can be created as either a single character string containing the Solr query, for example: <code>solrQuery = "q=id:doi*&amp;rows=2&amp;wt=json"</code>,
or as a list of key value pairs: <code>solrQuery = list(q = "id:doi*", rows = "2", wt = "json")</code>. These two queries produce the same result.</p>
<p>As an alternative to specifying the Solr query terms using the <code>"solrquery"</code> argument, the <code>"searchTerms"</code> argument
can be specified, which does not require any Solr syntax. This parameter is a list with query field / value pairs, i.e. 
<code>searchTerms=list(abstract=kelp, attribute=biomass)</code>.
The query fields can be listed for a DataONE node using <code><a href='getQueryEngineDescription.html'>getQueryEngineDescription</a></code>.
Either <code>"searchTerms"</code> or <code>"solrQuery"</code> must be specified.</p>
<p>The <code>"as"</code> argument is used to specify the query result to be returned as: "json", xml", "list", "data.frame".</p>
<p>The <code>"parsed"</code> argument, if specified as TRUE, causes the query result to be converted to appropriate R data types.
For example, if <code>ar = "xml"</code> and <code>parsed = TRUE</code>, then the query result is returned as an R XMLInternalDocument, or 
If <code>'parsed = FALSE'</code> then a character variable with the XML string is returned. Specify <code>as = "list"</code> to have 
the result parsed to an R list, with each list element containing one Solr query result of the total result set.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/DataONEorg/rdataone'>dataone</a></span><span class='op'>)</span>
<span class='va'>cn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='CNode.html'>CNode</a></span><span class='op'>(</span><span class='st'>"PROD"</span><span class='op'>)</span>
<span class='va'>queryParams</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>q<span class='op'>=</span><span class='st'>"id:doi*"</span>, rows<span class='op'>=</span><span class='st'>"5"</span>, 
    fq<span class='op'>=</span><span class='st'>"(abstract:chlorophyll AND dateUploaded:[2000-01-01T00:00:00Z TO NOW])"</span>, 
    fl<span class='op'>=</span><span class='st'>"title,id,abstract,size,dateUploaded,attributeName"</span><span class='op'>)</span>
<span class='co'># Return result as a list.</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>query</span><span class='op'>(</span><span class='va'>cn</span>, <span class='va'>queryParams</span>, as<span class='op'>=</span><span class='st'>"list"</span><span class='op'>)</span>

<span class='co'># Query and return the result as a data.frame of character values.</span>
<span class='va'>queryParams</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>q<span class='op'>=</span><span class='st'>"id:doi*"</span>, rows<span class='op'>=</span><span class='st'>"3"</span>, 
    fq<span class='op'>=</span><span class='st'>"(abstract:chlorophyll AND dateUploaded:[2000-01-01T00:00:00Z TO NOW])"</span>, 
    fl<span class='op'>=</span><span class='st'>"title,id,abstract,size,dateUploaded,attributeName"</span><span class='op'>)</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>query</span><span class='op'>(</span><span class='va'>cn</span>, <span class='va'>queryParams</span>, as<span class='op'>=</span><span class='st'>"data.frame"</span>, parse<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># Return the result as JSON</span>
<span class='va'>queryParams</span> <span class='op'>&lt;-</span> <span class='st'>"q=id:doi*&amp;rows=2&amp;wt=json"</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>query</span><span class='op'>(</span><span class='va'>cn</span>, <span class='va'>queryParams</span>, as<span class='op'>=</span><span class='st'>"json"</span><span class='op'>)</span>

<span class='co'># The following query shows how to embed quotes</span>
<span class='va'>cn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='CNode.html'>CNode</a></span><span class='op'>(</span><span class='st'>"SANDBOX2"</span><span class='op'>)</span>
<span class='va'>queryParamList</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>q<span class='op'>=</span><span class='st'>"(attribute:lake) and (attribute:\"Percent Nitrogen\")"</span>, rows<span class='op'>=</span><span class='st'>"1000"</span>,
                       fl<span class='op'>=</span><span class='st'>"title,id,abstract,size,dateUploaded,attributeName"</span>, wt<span class='op'>=</span><span class='st'>"xml"</span><span class='op'>)</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>query</span><span class='op'>(</span><span class='va'>cn</span>, <span class='va'>queryParamList</span>, as<span class='op'>=</span><span class='st'>"data.frame"</span><span class='op'>)</span>

<span class='co'># The following query uses the searchTerms parameter</span>
<span class='va'>cn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='CNode.html'>CNode</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>mn</span> <span class='op'>&lt;-</span> <span class='fu'><a href='getMNode.html'>getMNode</a></span><span class='op'>(</span><span class='va'>cn</span>, <span class='st'>"urn:node:KNB"</span><span class='op'>)</span>
<span class='va'>mySearchTerms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>abstract<span class='op'>=</span><span class='st'>"kelp"</span>, attribute<span class='op'>=</span><span class='st'>"biomass"</span><span class='op'>)</span>
<span class='va'>result</span> <span class='op'>&lt;-</span> <span class='fu'>query</span><span class='op'>(</span><span class='va'>mn</span>, searchTerms<span class='op'>=</span><span class='va'>mySearchTerms</span>, as<span class='op'>=</span><span class='st'>"data.frame"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Matthew B. Jones, Peter Slaughter, Rob Nahf, Carl Boettiger, Chris Jones, Bryce Mecum, Jeanette Clark, Lauren Walker.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


